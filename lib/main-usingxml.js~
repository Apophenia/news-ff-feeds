var widgets = require("sdk/widget");
var base64 = require("sdk/base64"); 
const { XMLHttpRequest } = require('sdk/net/xhr');

var username = "username";
var password = "pass";
var auth = base64.encode(username + ":" + password);

function getFeeds() {
    var request = new XMLHttpRequest();
    request.open("GET", "https://localhost/owncloud/index.php/apps/news/api/v1-2/feeds");
    request.setRequestHeader("Content-Type", "application/json");
    request.setRequestHeader("Authorization", "Basic " + auth);
    //   request.overrideMimeType("text/plain");
    request.onload = function()
    {
	console.log("Response received: " + request.responseText);
    };
    request.send(null);
}

/* function getFeeds() {
    var requestFeeds = Request({
	url: "http://localhost/owncloud/feeds",
	headers: {Authorization: auth},
	onComplete: function(response) {
	    console.log("done!");
	    console.log(response.json.feeds);
	}});
    requestFeeds.get();
    }; */	    

var widget = widgets.Widget({
    id: "mozilla-link",
    label: "Mozilla website",
    contentURL: "http://www.mozilla.org/favicon.ico",
    onClick: function() {
	    getFeeds();
    }
});
